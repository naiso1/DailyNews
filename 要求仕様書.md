# 要求仕様書：WordファイルからHTML生成および画像スクレイピングシステム

---

## 1. 文書情報

* 文書名：Wordファイル基盤 HTML 自動生成・画像スクレイピングシステム 要求仕様書
* 作成日：YYYY年MM月DD日
* 作成者：XXXX
* 版数：Ver. 1.0

---

## 2. システム概要

本システムは、**同一フォルダ内に格納された Word ファイル（.doc / .docx）を元に HTML ファイル（.html）を自動生成**し、
Wordファイル中に記載された **各サイトのURLから画像をスクレイピングして、HTML上に画像のリンク（および表示）を埋め込む** ことを目的とする。

生成されるHTMLページは、**先進的でセンスの良いデザイン**を持つことを前提とし、モダンなWebサイトとして閲覧可能なものとする。

---

## 3. 用語定義

* **Wordファイル**：拡張子 .doc / .docx のファイル。
* **HTMLファイル**：拡張子 .html の静的Webページ。
* **スクレイピング**：指定されたURLからWebページを取得し、HTML構造を解析して画像URL等の情報を抽出する処理。
* **同一フォルダ**：本システムの実行対象となる Word ファイルが格納されているフォルダ。出力HTMLファイルも原則として同一フォルダに出力するものとする。

---

## 4. 前提条件・制約

1. **対象ファイル配置**

   * 入力となる Wordファイル と 出力となる HTMLファイル は、原則として同一フォルダに配置する。
   * フォルダパスはユーザーが指定できるものとする。

2. **環境**

   * OS：Windowsを想定（例：Windows 10 以降）。
   * ネットワーク：画像スクレイピングを行うため、外部サイトへのHTTP/HTTPSアクセスが可能であること。

3. **権利・利用規約**

   * 画像スクレイピングは、対象サイトの **利用規約およびロボッツテキスト（robots.txt）** に反しない範囲で実施すること。
   * 必要に応じて、画像の取得ではなく **画像URLの取得・リンク表示のみに留める** など、法的リスクが少ない方式を選択する。

4. **Wordファイルの内容**

   * Wordファイル内には、通常のテキストに加え、**画像を掲載しているWebサイトのURL** が含まれていることを想定する。
   * URLは、`https://` または `http://` 形式で記載されているものを対象とする。

---

## 5. 機能要件

### 5.1 F-01：Wordファイルの読み込み

* 指定フォルダ内の Wordファイル（.doc / .docx）を自動検出する機能を持つ。
* 対象外のファイル形式（.txt, .pdf, .xlsx など）は処理しない。
* ファイルごとに以下の情報を取得する：

  * 本文テキスト
  * 本文内に含まれるURL文字列

### 5.2 F-02：URL抽出機能

* Wordファイル内の本文テキストから、URLを抽出する。
* 抽出対象：

  * `http://` または `https://` で始まる文字列
* 1つのWordファイル内に複数のURLが存在する場合、全て抽出し、重複を除外する。

### 5.3 F-03：画像スクレイピング機能

* 抽出された各URLにHTTP/HTTPSでアクセスし、HTMLソースを取得する。
* 取得したHTMLから、以下の要素を対象に画像URLを抽出する：

  * `<img>` タグの `src` 属性
* 相対パスの画像URLについては、元のサイトURLからの絶対URLに変換する。
* 1つのURLにつき、取得する画像URLの最大件数を設定可能とする（例：デフォルト 10件）。
* 画像そのものの保存は必須ではなく、**画像URLをHTML内にリンク／表示する**ことを主目的とする。

### 5.4 F-04：HTML生成機能

* 各Wordファイルに対して、対応するHTMLファイルを生成する。
* HTMLファイル名：

  * デフォルト：元のWordファイル名から拡張子を.htmlに変更した名称（例：`sample.docx` → `sample.html`）。
* HTMLの構成：

  * ページタイトル：元のWordファイル名（拡張子除く）を基本とする。
  * 本文領域：Wordファイルから抽出したテキストを構造化して表示する（段落単位）。
  * URL・画像領域：

    * 抽出されたURLリストを表示する。
    * 各URLごとに取得した画像URLを`<img>`タグとして表示、あるいは画像リンクとして表示する。

### 5.5 F-05：先進的でセンスの良いデザイン適用機能

* HTML/CSSベースで、**モダンで先進的なUI/UXデザイン**を適用する。

  * 例：

    * 余白やグリッドを意識したレイアウト
    * レスポンシブデザイン（PC/タブレット/スマホ対応）
    * フラットデザインやニューモーフィズム等、現代的なデザイン手法の採用
* デザイン要件（詳細は 6章参照）を満たすテンプレートを使用すること。

### 5.6 F-06：ログ出力・エラーハンドリング

* 以下の情報をログとして記録する：

  * 処理開始・終了時刻
  * 処理対象のWordファイル名
  * 抽出されたURL数
  * スクレイピング成功/失敗のURLと、その理由（例：タイムアウト、404、403など）
* エラー発生時の挙動：

  * 致命的エラーが発生した場合、処理を中断しエラーメッセージを表示。
  * 個別URLのスクレイピング失敗は、他URLや他ファイルの処理を継続する。

### 5.7 F-07：設定機能（任意）

* 設定ファイル（例：JSON / YAML 等）により、以下の項目を変更可能とする：

  * 処理対象フォルダパス
  * 1URLあたりの画像取得上限数
  * タイムアウト時間
  * デザインテーマ（将来的な拡張を想定）

---

## 6. デザイン要件（UI/UX）

1. **全体コンセプト**

   * 「先進的」「センスが良い」「クリーンで見やすい」ことをコンセプトとする。
   * ダークモード／ライトモードへの拡張が可能な構成が望ましい。

2. **レイアウト**

   * ヘッダー：タイトル（Wordファイル名）と簡単な説明を配置。
   * メインコンテンツ：

     * 左側：Word本文のテキスト（段落構造を保持）。
     * 右側または下部：URL一覧と画像一覧（カード型レイアウト等）。
   * レスポンシブデザイン：

     * スマホ閲覧時は縦一列レイアウトに自動切り替え。

3. **タイポグラフィ**

   * 見出し・本文・キャプションなど、用途に応じたフォントサイズと行間を設定。
   * 英文／日本文を混在させても見やすいフォント構成。

4. **画像表示**

   * 画像はカードデザイン（サムネイル + 画像URL + 元ページURL）で表示。
   * 画像が取得できなかった場合は、No Image のプレースホルダーとエラーメッセージを表示。

---

## 7. 非機能要件

### 7.1 性能

* 処理対象 Wordファイル数：目安として 50ファイル程度までを想定。
* 1ファイルあたりのURL数：目安として 20件程度までを想定。
* 通信環境に依存するが、タイムアウト設定により処理が極端に長引かないようにする。

### 7.2 保守性・拡張性

* デザインテンプレート、スクレイピングロジック、ファイル入出力ロジックを分離し、機能追加・修正が容易な構造とする。
* 新しいデザインテーマや、別の出力形式（例：PDF）への拡張が行いやすい構成とする。

### 7.3 セキュリティ

* 外部サイトへのアクセスはHTTPSを優先する。
* 不要な個人情報や認証情報をログに残さない。
* 利用規約違反となるような過度のスクレイピングや高頻度アクセスを避ける。

---

## 8. 入出力仕様

### 8.1 入力

* 入力フォルダ：

  * パス：ユーザー指定
  * 内容：.doc / .docx ファイル複数

### 8.2 出力

* 出力フォルダ：

  * 原則として入力フォルダと同一
* 出力物：

  * 各Wordファイルに対応するHTMLファイル（例：`xxx.docx` → `xxx.html`）
  * ログファイル（例：`log_YYYYMMDD.txt`）

---

## 9. 運用・操作フロー（例）

1. ユーザーが対象のWordファイルを同一フォルダに配置する。
2. システムを起動し、対象フォルダパスを指定する。
3. 「実行」操作により、Wordファイルの読み込み・URL抽出・画像スクレイピング・HTML生成が順次行われる。
4. 処理完了後、同フォルダ内にHTMLファイルが生成され、ユーザーはブラウザで閲覧する。
5. 必要に応じてログファイルで詳細結果を確認する。

---

## 10. 想定外事項と今後の検討

* Wordファイル内に画像が直接埋め込まれている場合、それらをHTMLに変換・埋め込む機能は本仕様では必須としない（将来拡張として検討）。
* JavaScriptによるインタラクティブなUI（モーダル表示、画像ビューア、フィルタリング機能等）は、優先度を要件定義フェーズで改めて検討する。

---

以上。
